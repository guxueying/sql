create table uni_05mth_0914 as select 
UNI_05MTH_STREAM.	USER_ID	,
UNI_05MTH_STREAM.	ID_1	,
UNI_05MTH_STREAM.	ID_2	,
UNI_05MTH_STREAM.	EPARCHY_CODE_201505	,
UNI_05MTH_STREAM.	ACTION_END_DATE_201505	,
UNI_05MTH_STREAM.	CREDIT_VALUE_201505	,
UNI_05MTH_STREAM.	JOIN_MONTH_201505	,
UNI_05MTH_STREAM.	VOICE_TAG_201505	,
UNI_05MTH_STREAM.	ROAM_TAG_03_201505	,
UNI_05MTH_STREAM.	MTC_NUM_201505	,
UNI_05MTH_STREAM.	NO_LCALL_DURATION_201505	,
UNI_05MTH_STREAM.	PROV_LCALL_DURATION_201505	,
UNI_05MTH_STREAM.	NATIONAL_LCALL_DURATION_201505	,
UNI_05MTH_STREAM.	INTERGAT_LCALL_DURATION_201505	,
UNI_05MTH_STREAM.	NOINTERGATLCALLDURATION_201505	,
UNI_05MTH_STREAM.	ROAM_CALL_DURATION_201505	,
UNI_05MTH_STREAM.	BILL_DURATION_01_201505	,
UNI_05MTH_STREAM.	CZ_FEE_01_201505	,
UNI_05MTH_STREAM.	CUR_INCOME_201505	,
UNI_05MTH_STREAM.	PROM_FEE_201505	,
UNI_05MTH_STREAM.	DEBT_FEE_201505	,
UNI_05MTH_STREAM.	NOT_PACKAGE_USE_201505_201505	,
UNI_05MTH_STREAM.	FREE_FLOW_USE_201505	,
UNI_05MTH_STREAM.	ROAM_STREAM_01_201505	,
UNI_05MTH_STREAM.	ROAM_STREAM_02_201505	,
UNI_05MTH_STREAM.	ROAM_STREAM_04_201505	,
UNI_05MTH_STREAM.	VOICEOVER_TAG_201505	,
UNI_05MTH_STREAM.	SMS_NUMS_201505	,
UNI_05MTH_STREAM.	EPARCHY_TYPE_201505	,
UNI_05MTH_STREAM.	LOST_TAG_201502	,
UNI_05MTH_STREAM.	LOST_TAG_201503	,
UNI_05MTH_STREAM.	LOST_TAG_201504	,
UNI_05MTH_STREAM.	LOST_TAG_201505	,
UNI_05MTH_STREAM.	LOST_TAG_201506	,
UNI_05MTH_STREAM.	LOST_TAG_201507	,
UNI_05MTH_STREAM.	USER_STATE_CODESET_20150531	,
UNI_05MTH_STREAM.	USER_STATE_CODESET_20150515	,
UNI_05MTH_STREAM.	USER_STATE_CODESET_20150430	,
UNI_05MTH_STREAM.	JOIN_MONTH_201502	,
UNI_05MTH_STREAM.	TOTAL_STREAM_02	,
UNI_05MTH_STREAM.	TOTAL_STREAM_03	,
UNI_05MTH_STREAM.	TOTAL_STREAM_04	,
UNI_05MTH_STREAM.	TOTAL_STREAM_05	,
UNI_05MTH_STREAM.	TAGOF_STREAM	,
A_4G_4.	TOTAL_CALL_TIMES_02	,
A_4G_4.	TOTAL_CALL_TIMES_03	,
A_4G_4.	TOTAL_CALL_TIMES_04	,
A_4G_4.	TOTAL_CALL_TIMES_05	,
UNI_05MTH_STREAM.	LOST_TAG_5_T2_4G	
from A_4G_4,UNI_05MTH_STREAM
where UNI_05MTH_STREAM.user_id=A_4G_4.user_id;

create table uni_06mth_0914 as select 
UNI_06MTH_STREAM.	USER_ID	,
UNI_06MTH_STREAM.	ID_1	,
UNI_06MTH_STREAM.	ID_2	,
UNI_06MTH_STREAM.	EPARCHY_CODE_201506	,
UNI_06MTH_STREAM.	ACTION_END_DATE_201506	,
UNI_06MTH_STREAM.	CREDIT_VALUE_201506	,
UNI_06MTH_STREAM.	JOIN_MONTH_201506	,
UNI_06MTH_STREAM.	VOICE_TAG_201506	,
UNI_06MTH_STREAM.	ROAM_TAG_03_201506	,
UNI_06MTH_STREAM.	MTC_NUM_201506	,
UNI_06MTH_STREAM.	NO_LCALL_DURATION_201506	,
UNI_06MTH_STREAM.	PROV_LCALL_DURATION_201506	,
UNI_06MTH_STREAM.	NATIONAL_LCALL_DURATION_201506	,
UNI_06MTH_STREAM.	INTERGAT_LCALL_DURATION_201506	,
UNI_06MTH_STREAM.	NOINTERGATLCALLDURATION_201506	,
UNI_06MTH_STREAM.	ROAM_CALL_DURATION_201506	,
UNI_06MTH_STREAM.	BILL_DURATION_01_201506	,
UNI_06MTH_STREAM.	CZ_FEE_01_201506	,
UNI_06MTH_STREAM.	CUR_INCOME_201506	,
UNI_06MTH_STREAM.	PROM_FEE_201506	,
UNI_06MTH_STREAM.	DEBT_FEE_201506	,
UNI_06MTH_STREAM.	NOT_PACKAGE_USE_201506_201506	,
UNI_06MTH_STREAM.	FREE_FLOW_USE_201506	,
UNI_06MTH_STREAM.	ROAM_STREAM_01_201506	,
UNI_06MTH_STREAM.	ROAM_STREAM_02_201506	,
UNI_06MTH_STREAM.	ROAM_STREAM_04_201506	,
UNI_06MTH_STREAM.	VOICEOVER_TAG_201506	,
UNI_06MTH_STREAM.	SMS_NUMS_201506	,
UNI_06MTH_STREAM.	EPARCHY_TYPE_201506	,
UNI_06MTH_STREAM.	LOST_TAG_201508	,
UNI_06MTH_STREAM.	LOST_TAG_201503	,
UNI_06MTH_STREAM.	LOST_TAG_201504	,
UNI_06MTH_STREAM.	LOST_TAG_201505	,
UNI_06MTH_STREAM.	LOST_TAG_201506	,
UNI_06MTH_STREAM.	LOST_TAG_201507	,
UNI_06MTH_STREAM.	USER_STATE_CODESET_20150630	,
UNI_06MTH_STREAM.	USER_STATE_CODESET_20150615	,
UNI_06MTH_STREAM.	USER_STATE_CODESET_20150531	,
UNI_06MTH_STREAM.	JOIN_MONTH_201503	,
UNI_06MTH_STREAM.	TOTAL_STREAM_06	,
UNI_06MTH_STREAM.	TOTAL_STREAM_03	,
UNI_06MTH_STREAM.	TOTAL_STREAM_04	,
UNI_06MTH_STREAM.	TOTAL_STREAM_05	,
UNI_06MTH_STREAM.	TAGOF_STREAM	,
A_4G_4.	TOTAL_CALL_TIMES_02	,
A_4G_4.	TOTAL_CALL_TIMES_03	,
A_4G_4.	TOTAL_CALL_TIMES_04	,
A_4G_4.	TOTAL_CALL_TIMES_05	,
UNI_06MTH_STREAM.	LOST_TAG_6_T2_4G	
from A_4G_4,UNI_06MTH_STREAM
where UNI_06MTH_STREAM.user_id=A_4G_4.user_id;

alter table UNI_05MTH_0914 add tagof_call number;
alter table UNI_06MTH_0914 add tagof_call number;
update UNI_05MTH_0914 set tagof_call=0;
update UNI_06MTH_0914 set tagof_call=0;
update UNI_05MTH_0914 set tagof_call=1 where 
join_month_201502=0 and TOTAL_CALL_TIMES_02+
TOTAL_CALL_TIMES_03+
TOTAL_CALL_TIMES_04<=20;
update UNI_06MTH_0914 set tagof_call=1 where 
join_month_201503=0 and TOTAL_CALL_TIMES_05+
TOTAL_CALL_TIMES_03+
TOTAL_CALL_TIMES_04<=20;


create table yuanshishuju_0914_6 as (select	
	to_number(EPARCHY_CODE_201506) as EPARCHY_CODE_201506
	,to_number(USER_ID) as USER_ID
	,to_number(ID_1) as ID_1
	,to_number(ID_2) as ID_2
	,to_number(EPARCHY_TYPE_201506) as EPARCHY_TYPE_201506
	,to_number(ACTION_END_DATE_201506) as ACTION_END_DATE_201506
	,to_number(CREDIT_VALUE_201506) as CREDIT_VALUE_201506
	,to_number(JOIN_MONTH_201506) as JOIN_MONTH_201506
	,to_number(ROAM_TAG_03_201506) as ROAM_TAG_03_201506
	,to_number(MTC_NUM_201506) as MTC_NUM_201506
	,to_number(NO_LCALL_DURATION_201506) as NO_LCALL_DURATION_201506
	,to_number(PROV_LCALL_DURATION_201506) as PROV_LCALL_DURATION_201506
	,to_number(NATIONAL_LCALL_DURATION_201506) as NATIONAL_LCALL_DURATION_201506
	,to_number(INTERGAT_LCALL_DURATION_201506) as INTERGAT_LCALL_DURATION_201506
	,to_number(NOINTERGATLCALLDURATION_201506) as NOINTERGATLCALLDURATION_201506
	,to_number(ROAM_CALL_DURATION_201506) as ROAM_CALL_DURATION_201506
	,to_number(BILL_DURATION_01_201506) as BILL_DURATION_01_201506
	,to_number(CZ_FEE_01_201506) as CZ_FEE_01_201506
	,to_number(CUR_INCOME_201506) as CUR_INCOME_201506
	,to_number(PROM_FEE_201506) as PROM_FEE_201506
	,to_number(DEBT_FEE_201506) as DEBT_FEE_201506
	,to_number(NOT_PACKAGE_USE_201506_201506) as NOT_PACKAGE_USE_201506_201506
	,to_number(FREE_FLOW_USE_201506) as FREE_FLOW_USE_201506
	,to_number(ROAM_STREAM_01_201506) as ROAM_STREAM_01_201506
	,to_number(ROAM_STREAM_02_201506) as ROAM_STREAM_02_201506
	,to_number(ROAM_STREAM_04_201506) as ROAM_STREAM_04_201506
	,to_number(VOICEOVER_TAG_201506) as VOICEOVER_TAG_201506
	,to_number(SMS_NUMS_201506) as SMS_NUMS_201506
	,to_number(USER_STATE_CODESET_20150630) as USER_STATE_CODESET_20150630
	,to_number(USER_STATE_CODESET_20150615) as USER_STATE_CODESET_20150615
	,to_number(USER_STATE_CODESET_20150531) as USER_STATE_CODESET_20150531
	,to_number(tagof_call) as tagof_call
  ,to_number(LOST_TAG_6_T2_4g) as LOST_TAG_6_T2_4g
	from uni_06mth_0914 where lost_TAG_6_t2_4g!=-1);
  
  create table yuanshishuju_0914_5 as (select
to_number(EPARCHY_CODE_201505) as EPARCHY_CODE_201505
,to_number(USER_ID) as USER_ID
,to_number(ID_1) as ID_1
,to_number(ID_2) as ID_2
,to_number(EPARCHY_TYPE_201505) as EPARCHY_TYPE_201505
,to_number(ACTION_END_DATE_201505) as ACTION_END_DATE_201505
,to_number(CREDIT_VALUE_201505) as CREDIT_VALUE_201505
,to_number(JOIN_MONTH_201505) as JOIN_MONTH_201505
,to_number(ROAM_TAG_03_201505) as ROAM_TAG_03_201505
,to_number(MTC_NUM_201505) as MTC_NUM_201505
,to_number(NO_LCALL_DURATION_201505) as NO_LCALL_DURATION_201505
,to_number(PROV_LCALL_DURATION_201505) as PROV_LCALL_DURATION_201505
,to_number(NATIONAL_LCALL_DURATION_201505) as NATIONAL_LCALL_DURATION_201505
,to_number(INTERGAT_LCALL_DURATION_201505) as INTERGAT_LCALL_DURATION_201505
,to_number(NOINTERGATLCALLDURATION_201505) as NOINTERGATLCALLDURATION_201505
,to_number(ROAM_CALL_DURATION_201505) as ROAM_CALL_DURATION_201505
,to_number(BILL_DURATION_01_201505) as BILL_DURATION_01_201505
,to_number(CZ_FEE_01_201505) as CZ_FEE_01_201505
,to_number(CUR_INCOME_201505) as CUR_INCOME_201505
,to_number(PROM_FEE_201505) as PROM_FEE_201505
,to_number(DEBT_FEE_201505) as DEBT_FEE_201505
,to_number(NOT_PACKAGE_USE_201505_201505) as NOT_PACKAGE_USE_201505_201505
,to_number(FREE_FLOW_USE_201505) as FREE_FLOW_USE_201505
,to_number(ROAM_STREAM_01_201505) as ROAM_STREAM_01_201505
,to_number(ROAM_STREAM_02_201505) as ROAM_STREAM_02_201505
,to_number(ROAM_STREAM_04_201505) as ROAM_STREAM_04_201505
,to_number(VOICEOVER_TAG_201505) as VOICEOVER_TAG_201505
,to_number(SMS_NUMS_201505) as SMS_NUMS_201505
,to_number(USER_STATE_CODESET_20150531) as USER_STATE_CODESET_20150531
,to_number(USER_STATE_CODESET_20150515) as USER_STATE_CODESET_20150515
,to_number(USER_STATE_CODESET_20150430) as USER_STATE_CODESET_20150430
,to_number(tagof_call) as tagof_call
,to_number(LOST_TAG_5_T2_4g) as LOST_TAG_5_T2_4g
from uni_05mth_0914 where lost_tag_5_t2_4g!=-1);
