create table uni_05mth_1102 as (select
ASIAINFO_MON_QX_5_4G.	EPARCHY_CODE_201505,
	ASIAINFO_MON_QX_5_4G.USER_ID,
	(ASIAINFO_MON_QX_5_4G.USER_ID-mod(ASIAINFO_MON_QX_5_4G.USER_ID,10))/10 as ID_1,
	mod(ASIAINFO_MON_QX_5_4G.USER_ID,10) as ID_2,
ASIAINFO_MON_QX_5_4G.	EPARCHY_TYPE_201505,
ASIAINFO_MON_QX_5_4G.	ACTION_END_DATE_201505,
ASIAINFO_MON_QX_5_4G.	CREDIT_VALUE_201505,
ASIAINFO_MON_QX_5_4G.	JOIN_MONTH_201505,
ASIAINFO_MON_QX_5_4G.	VOICE_TAG_201505,
ASIAINFO_MON_QX_5_4G.	ROAM_TAG_03_201505,
ASIAINFO_MON_QX_5_4G.	MTC_NUM_201505,
ASIAINFO_MON_QX_5_4G.	NO_LCALL_DURATION_201505,
ASIAINFO_MON_QX_5_4G.	PROV_LCALL_DURATION_201505,
ASIAINFO_MON_QX_5_4G.	NATIONAL_LCALL_DURATION_201505,
ASIAINFO_MON_QX_5_4G.	INTERGAT_LCALL_DURATION_201505,
ASIAINFO_MON_QX_5_4G.	NOINTERGATLCALLDURATION_201505,
ASIAINFO_MON_QX_5_4G.	ROAM_CALL_DURATION_201505,
ASIAINFO_MON_QX_5_4G.	BILL_DURATION_01_201505,
ASIAINFO_MON_QX_5_4G.	CZ_FEE_01_201505,
ASIAINFO_MON_QX_5_4G.	CUR_INCOME_201505,
ASIAINFO_MON_QX_5_4G.	PROM_FEE_201505,
ASIAINFO_MON_QX_5_4G.	DEBT_FEE_201505,
ASIAINFO_MON_QX_5_4G.	NOT_PACKAGE_USE_201505_201505,
ASIAINFO_MON_QX_5_4G.	FREE_FLOW_USE_201505,
ASIAINFO_MON_QX_5_4G.	ROAM_STREAM_01_201505,
ASIAINFO_MON_QX_5_4G.	ROAM_STREAM_02_201505,
ASIAINFO_MON_QX_5_4G.	ROAM_STREAM_04_201505,
ASIAINFO_MON_QX_5_4G.	VOICEOVER_TAG_201505,
ASIAINFO_MON_QX_5_4G.	SMS_NUMS_201505,
ASIAINFO_MON_QX_5_4G.	LOST_TAG_201502,
ASIAINFO_MON_QX_5_4G.	LOST_TAG_201503,
ASIAINFO_MON_QX_5_4G.	LOST_TAG_201504,
ASIAINFO_MON_QX_5_4G.	LOST_TAG_201505,
ASIAINFO_MON_QX_5_4G.	LOST_TAG_201506,
ASIAINFO_ZDLS_MON_6.	LOST_TAG_201507,
ASIAINFO_ZDLS_MON_6.	LOST_TAG_201508,
	ASIAINFO_USERSTCODESET_QX_4_4G.USER_STATE_CODESET_20150523,
	ASIAINFO_USERSTCODESET_QX_4_4G.USER_STATE_CODESET_20150501,
	ASIAINFO_USERSTCODESET_QX_4_4G.USER_STATE_CODESET_20150430
	from ASIAINFO_ZDLS_MON_6,ASIAINFO_USERSTCODESET_QX_4_4G,ASIAINFO_MON_QX_5_4G
	where ASIAINFO_ZDLS_MON_6.user_id=ASIAINFO_USERSTCODESET_QX_4_4G.user_id
	and ASIAINFO_MON_QX_5_4G.user_id=ASIAINFO_USERSTCODESET_QX_4_4G.user_id);

create table uni_06mth_1102 as (select	
ASIAINFO_MON_QX_6_4G.EPARCHY_CODE_201506,	
ASIAINFO_MON_QX_6_4G.USER_ID,	
(ASIAINFO_MON_QX_6_4G.USER_ID-mod(ASIAINFO_MON_QX_6_4G.USER_ID,10))/10 as ID_1,	
mod(ASIAINFO_MON_QX_6_4G.USER_ID,10) as ID_2,	
ASIAINFO_MON_QX_6_4G.	EPARCHY_TYPE_201506,
ASIAINFO_MON_QX_6_4G.	ACTION_END_DATE_201506,
ASIAINFO_MON_QX_6_4G.	CREDIT_VALUE_201506,
ASIAINFO_MON_QX_6_4G.	JOIN_MONTH_201506,
ASIAINFO_MON_QX_6_4G.	VOICE_TAG_201506,
ASIAINFO_MON_QX_6_4G.	ROAM_TAG_03_201506,
ASIAINFO_MON_QX_6_4G.	MTC_NUM_201506,
ASIAINFO_MON_QX_6_4G.	NO_LCALL_DURATION_201506,
ASIAINFO_MON_QX_6_4G. PROV_LCALL_DURATION_201506,	
ASIAINFO_MON_QX_6_4G.	NATIONAL_LCALL_DURATION_201506,
ASIAINFO_MON_QX_6_4G.	INTERGAT_LCALL_DURATION_201506,
ASIAINFO_MON_QX_6_4G.	NOINTERGATLCALLDURATION_201506,
ASIAINFO_MON_QX_6_4G.	ROAM_CALL_DURATION_201506,
ASIAINFO_MON_QX_6_4G.	BILL_DURATION_01_201506,
ASIAINFO_MON_QX_6_4G.	CZ_FEE_01_201506,
ASIAINFO_MON_QX_6_4G.	CUR_INCOME_201506,
ASIAINFO_MON_QX_6_4G.	PROM_FEE_201506,
ASIAINFO_MON_QX_6_4G. DEBT_FEE_201506,	
ASIAINFO_MON_QX_6_4G.	NOT_PACKAGE_USE_201506_201506,
ASIAINFO_MON_QX_6_4G.	FREE_FLOW_USE_201506,
ASIAINFO_MON_QX_6_4G.	ROAM_STREAM_01_201506,
ASIAINFO_MON_QX_6_4G.	ROAM_STREAM_02_201506,
ASIAINFO_MON_QX_6_4G.	ROAM_STREAM_04_201506,
ASIAINFO_MON_QX_6_4G.	VOICEOVER_TAG_201506,
ASIAINFO_MON_QX_6_4G.SMS_NUMS_201506,	
ASIAINFO_ZDLS_MON_7.LOST_TAG_201509,	
ASIAINFO_MON_QX_6_4G.LOST_TAG_201503,	
ASIAINFO_MON_QX_6_4G.LOST_TAG_201504,	
ASIAINFO_MON_QX_6_4G.LOST_TAG_201506,	
ASIAINFO_MON_QX_6_4G.LOST_TAG_201505,	
ASIAINFO_MON_QX_6_4G.LOST_TAG_201507,	
ASIAINFO_ZDLS_MON_7.LOST_TAG_201508,	
ASIAINFO_USERSTCODESET_QX_5_4G.USER_STATE_CODESET_20150623,	
ASIAINFO_USERSTCODESET_QX_5_4G.USER_STATE_CODESET_20150601,	
ASIAINFO_USERSTCODESET_QX_5_4G.USER_STATE_CODESET_20150531	
from ASIAINFO_MON_QX_6_4G,ASIAINFO_USERSTCODESET_QX_5_4G,ASIAINFO_ZDLS_MON_7	
where ASIAINFO_ZDLS_MON_7.user_id=ASIAINFO_USERSTCODESET_QX_5_4G.user_id	
and ASIAINFO_MON_QX_6_4G.user_id=ASIAINFO_USERSTCODESET_QX_5_4G.user_id);	


update uni_05mth_1102 set USER_STATE_CODESET_20150523='3' where USER_STATE_CODESET_20150523='2';	
	update uni_05mth_1102 set USER_STATE_CODESET_20150523='2' where USER_STATE_CODESET_20150523='4';
	update uni_05mth_1102 set USER_STATE_CODESET_20150523='4' where USER_STATE_CODESET_20150523='6';
	update uni_05mth_1102 set USER_STATE_CODESET_20150523='7' where USER_STATE_CODESET_20150523='7';
	update uni_05mth_1102 set USER_STATE_CODESET_20150523='5' where USER_STATE_CODESET_20150523='5';
	update uni_05mth_1102 set USER_STATE_CODESET_20150523='6' where USER_STATE_CODESET_20150523='9';
	update uni_05mth_1102 set USER_STATE_CODESET_20150523='2' where USER_STATE_CODESET_20150523='A';
	update uni_05mth_1102 set USER_STATE_CODESET_20150523='3' where USER_STATE_CODESET_20150523='B';
	update uni_05mth_1102 set USER_STATE_CODESET_20150523='4' where USER_STATE_CODESET_20150523='F';
	update uni_05mth_1102 set USER_STATE_CODESET_20150523='2' where USER_STATE_CODESET_20150523='K';
	update uni_05mth_1102 set USER_STATE_CODESET_20150523='5' where USER_STATE_CODESET_20150523='N';
	update uni_05mth_1102 set USER_STATE_CODESET_20150523='5' where USER_STATE_CODESET_20150523='O';
	update uni_05mth_1102 set USER_STATE_CODESET_20150523='5' where USER_STATE_CODESET_20150523='T';
	update uni_05mth_1102 set USER_STATE_CODESET_20150523='6' where USER_STATE_CODESET_20150523='U';
	update uni_05mth_1102 set USER_STATE_CODESET_20150523='5' where USER_STATE_CODESET_20150523='X';
	update uni_05mth_1102 set USER_STATE_CODESET_20150523='5' where USER_STATE_CODESET_20150523='M';
	update uni_05mth_1102 set USER_STATE_CODESET_20150523='5' where USER_STATE_CODESET_20150523='e';
	
	update uni_05mth_1102 set USER_STATE_CODESET_20150501='3' where USER_STATE_CODESET_20150501='2';
	update uni_05mth_1102 set USER_STATE_CODESET_20150501='2' where USER_STATE_CODESET_20150501='4';
	update uni_05mth_1102 set USER_STATE_CODESET_20150501='4' where USER_STATE_CODESET_20150501='6';
	update uni_05mth_1102 set USER_STATE_CODESET_20150501='7' where USER_STATE_CODESET_20150501='7';
	update uni_05mth_1102 set USER_STATE_CODESET_20150501='5' where USER_STATE_CODESET_20150501='5';
	update uni_05mth_1102 set USER_STATE_CODESET_20150501='6' where USER_STATE_CODESET_20150501='9';
	update uni_05mth_1102 set USER_STATE_CODESET_20150501='2' where USER_STATE_CODESET_20150501='A';
	update uni_05mth_1102 set USER_STATE_CODESET_20150501='3' where USER_STATE_CODESET_20150501='B';
	update uni_05mth_1102 set USER_STATE_CODESET_20150501='4' where USER_STATE_CODESET_20150501='F';
	update uni_05mth_1102 set USER_STATE_CODESET_20150501='2' where USER_STATE_CODESET_20150501='K';
	update uni_05mth_1102 set USER_STATE_CODESET_20150501='5' where USER_STATE_CODESET_20150501='N';
	update uni_05mth_1102 set USER_STATE_CODESET_20150501='5' where USER_STATE_CODESET_20150501='O';
	update uni_05mth_1102 set USER_STATE_CODESET_20150501='5' where USER_STATE_CODESET_20150501='T';
	update uni_05mth_1102 set USER_STATE_CODESET_20150501='6' where USER_STATE_CODESET_20150501='U';
	update uni_05mth_1102 set USER_STATE_CODESET_20150501='5' where USER_STATE_CODESET_20150501='X';
	update uni_05mth_1102 set USER_STATE_CODESET_20150501='5' where USER_STATE_CODESET_20150501='M';
	update uni_05mth_1102 set USER_STATE_CODESET_20150501='5' where USER_STATE_CODESET_20150501='e';
	
	update uni_05mth_1102 set USER_STATE_CODESET_20150430='3' where USER_STATE_CODESET_20150430='2';
	update uni_05mth_1102 set USER_STATE_CODESET_20150430='2' where USER_STATE_CODESET_20150430='4';
	update uni_05mth_1102 set USER_STATE_CODESET_20150430='4' where USER_STATE_CODESET_20150430='6';
	update uni_05mth_1102 set USER_STATE_CODESET_20150430='7' where USER_STATE_CODESET_20150430='7';
	update uni_05mth_1102 set USER_STATE_CODESET_20150430='5' where USER_STATE_CODESET_20150430='5';
	update uni_05mth_1102 set USER_STATE_CODESET_20150430='6' where USER_STATE_CODESET_20150430='9';
	update uni_05mth_1102 set USER_STATE_CODESET_20150430='2' where USER_STATE_CODESET_20150430='A';
	update uni_05mth_1102 set USER_STATE_CODESET_20150430='3' where USER_STATE_CODESET_20150430='B';
	update uni_05mth_1102 set USER_STATE_CODESET_20150430='4' where USER_STATE_CODESET_20150430='F';
	update uni_05mth_1102 set USER_STATE_CODESET_20150430='2' where USER_STATE_CODESET_20150430='K';
	update uni_05mth_1102 set USER_STATE_CODESET_20150430='5' where USER_STATE_CODESET_20150430='N';
	update uni_05mth_1102 set USER_STATE_CODESET_20150430='5' where USER_STATE_CODESET_20150430='O';
	update uni_05mth_1102 set USER_STATE_CODESET_20150430='5' where USER_STATE_CODESET_20150430='T';
	update uni_05mth_1102 set USER_STATE_CODESET_20150430='6' where USER_STATE_CODESET_20150430='U';
	update uni_05mth_1102 set USER_STATE_CODESET_20150430='5' where USER_STATE_CODESET_20150430='X';
	update uni_05mth_1102 set USER_STATE_CODESET_20150430='5' where USER_STATE_CODESET_20150430='M';
	update uni_05mth_1102 set USER_STATE_CODESET_20150430='5' where USER_STATE_CODESET_20150430='e';

alter table uni_05mth_1102 add lost_tag_5_t2_4g number;	
	update uni_05mth_1102 set lost_tag_5_t2_4g=-1;

update uni_05mth_1102 set lost_tag_5_t2_4g=0 where
(LOST_TAG_201502=0 and
LOST_TAG_201503=0 and
LOST_TAG_201504=0 and
LOST_TAG_201505=0 and
LOST_TAG_201506=0 and
LOST_TAG_201507=0 and
LOST_TAG_201508=0 ) or
(LOST_TAG_201502=2 and
LOST_TAG_201503=0 and
LOST_TAG_201504=0 and
LOST_TAG_201505=0 and
LOST_TAG_201506=0 and
LOST_TAG_201507=0 and
LOST_TAG_201508=0 ) or
(LOST_TAG_201502=2 and
LOST_TAG_201503=2 and
LOST_TAG_201504=0 and
LOST_TAG_201505=0 and
LOST_TAG_201506=0 and
LOST_TAG_201507=0 and
LOST_TAG_201508=0
);

update uni_05mth_1102 set lost_tag_5_t2_4g=1 where
(LOST_TAG_201502=0 and
LOST_TAG_201503=0 and
LOST_TAG_201504=0 and
LOST_TAG_201505=0 and
LOST_TAG_201506=0 and
LOST_TAG_201507=1) or
(LOST_TAG_201502=2 and
LOST_TAG_201503=0 and
LOST_TAG_201504=0 and
LOST_TAG_201505=0 and
LOST_TAG_201506=0 and
LOST_TAG_201507=1 ) or
(LOST_TAG_201502=2 and
LOST_TAG_201503=2 and
LOST_TAG_201504=0 and
LOST_TAG_201505=0 and
LOST_TAG_201506=0 and
LOST_TAG_201507=1) or
(LOST_TAG_201502=0 and
LOST_TAG_201503=0 and
LOST_TAG_201504=0 and
LOST_TAG_201505=0 and
LOST_TAG_201506=0 and
LOST_TAG_201508=1) or
(LOST_TAG_201502=2 and
LOST_TAG_201503=0 and
LOST_TAG_201504=0 and
LOST_TAG_201505=0 and
LOST_TAG_201506=0 and
LOST_TAG_201508=1 ) or
(LOST_TAG_201502=2 and
LOST_TAG_201503=2 and
LOST_TAG_201504=0 and
LOST_TAG_201505=0 and
LOST_TAG_201506=0 and
LOST_TAG_201508=1
);

update uni_05mth_1102 set EPARCHY_TYPE_201505=EPARCHY_TYPE_201505-1;

update uni_05mth_1102 set CREDIT_VALUE_201505=-1 where CREDIT_VALUE_201505=0;	
	update uni_05mth_1102 set MTC_NUM_201505=-1 where MTC_NUM_201505=0;
	update uni_05mth_1102 set NO_LCALL_DURATION_201505=-1 where NO_LCALL_DURATION_201505=0;
	update uni_05mth_1102 set PROV_LCALL_DURATION_201505=-1 where PROV_LCALL_DURATION_201505=0;
	update uni_05mth_1102 set NATIONAL_LCALL_DURATION_201505=-1 where NATIONAL_LCALL_DURATION_201505=0;
	update uni_05mth_1102 set INTERGAT_LCALL_DURATION_201505=-1 where INTERGAT_LCALL_DURATION_201505=0;
	update uni_05mth_1102 set NOINTERGATLCALLDURATION_201505=-1 where NOINTERGATLCALLDURATION_201505=0;
	update uni_05mth_1102 set ROAM_CALL_DURATION_201505=-1 where ROAM_CALL_DURATION_201505=0;
	update uni_05mth_1102 set BILL_DURATION_01_201505=-1 where BILL_DURATION_01_201505=0;
	update uni_05mth_1102 set DEBT_FEE_201505=-1 where DEBT_FEE_201505=0;
	update uni_05mth_1102 set NOT_PACKAGE_USE_201505_201505=-1 where NOT_PACKAGE_USE_201505_201505=0;
	update uni_05mth_1102 set FREE_FLOW_USE_201505=-1 where FREE_FLOW_USE_201505=0;
	update uni_05mth_1102 set ROAM_STREAM_01_201505=-1 where ROAM_STREAM_01_201505=0;
	update uni_05mth_1102 set ROAM_STREAM_02_201505=-1 where ROAM_STREAM_02_201505=0;
	update uni_05mth_1102 set ROAM_STREAM_04_201505=-1 where ROAM_STREAM_04_201505=0;
	update uni_05mth_1102 set SMS_NUMS_201505=-1 where SMS_NUMS_201505=0;






update uni_06mth_1102 set USER_STATE_CODESET_20150623='3' where USER_STATE_CODESET_20150623='2';	
	update uni_06mth_1102 set USER_STATE_CODESET_20150623='2' where USER_STATE_CODESET_20150623='4';
	update uni_06mth_1102 set USER_STATE_CODESET_20150623='4' where USER_STATE_CODESET_20150623='6';
	update uni_06mth_1102 set USER_STATE_CODESET_20150623='7' where USER_STATE_CODESET_20150623='7';
	update uni_06mth_1102 set USER_STATE_CODESET_20150623='5' where USER_STATE_CODESET_20150623='5';
	update uni_06mth_1102 set USER_STATE_CODESET_20150623='6' where USER_STATE_CODESET_20150623='9';
	update uni_06mth_1102 set USER_STATE_CODESET_20150623='2' where USER_STATE_CODESET_20150623='A';
	update uni_06mth_1102 set USER_STATE_CODESET_20150623='3' where USER_STATE_CODESET_20150623='B';
	update uni_06mth_1102 set USER_STATE_CODESET_20150623='4' where USER_STATE_CODESET_20150623='F';
	update uni_06mth_1102 set USER_STATE_CODESET_20150623='2' where USER_STATE_CODESET_20150623='K';
	update uni_06mth_1102 set USER_STATE_CODESET_20150623='5' where USER_STATE_CODESET_20150623='N';
	update uni_06mth_1102 set USER_STATE_CODESET_20150623='5' where USER_STATE_CODESET_20150623='O';
	update uni_06mth_1102 set USER_STATE_CODESET_20150623='5' where USER_STATE_CODESET_20150623='T';
	update uni_06mth_1102 set USER_STATE_CODESET_20150623='6' where USER_STATE_CODESET_20150623='U';
	update uni_06mth_1102 set USER_STATE_CODESET_20150623='5' where USER_STATE_CODESET_20150623='X';
	update uni_06mth_1102 set USER_STATE_CODESET_20150623='5' where USER_STATE_CODESET_20150623='M';
	update uni_06mth_1102 set USER_STATE_CODESET_20150623='5' where USER_STATE_CODESET_20150623='e';
	
	update uni_06mth_1102 set USER_STATE_CODESET_20150601='3' where USER_STATE_CODESET_20150601='2';
	update uni_06mth_1102 set USER_STATE_CODESET_20150601='2' where USER_STATE_CODESET_20150601='4';
	update uni_06mth_1102 set USER_STATE_CODESET_20150601='4' where USER_STATE_CODESET_20150601='6';
	update uni_06mth_1102 set USER_STATE_CODESET_20150601='7' where USER_STATE_CODESET_20150601='7';
	update uni_06mth_1102 set USER_STATE_CODESET_20150601='5' where USER_STATE_CODESET_20150601='5';
	update uni_06mth_1102 set USER_STATE_CODESET_20150601='6' where USER_STATE_CODESET_20150601='9';
	update uni_06mth_1102 set USER_STATE_CODESET_20150601='2' where USER_STATE_CODESET_20150601='A';
	update uni_06mth_1102 set USER_STATE_CODESET_20150601='3' where USER_STATE_CODESET_20150601='B';
	update uni_06mth_1102 set USER_STATE_CODESET_20150601='4' where USER_STATE_CODESET_20150601='F';
	update uni_06mth_1102 set USER_STATE_CODESET_20150601='2' where USER_STATE_CODESET_20150601='K';
	update uni_06mth_1102 set USER_STATE_CODESET_20150601='5' where USER_STATE_CODESET_20150601='N';
	update uni_06mth_1102 set USER_STATE_CODESET_20150601='5' where USER_STATE_CODESET_20150601='O';
	update uni_06mth_1102 set USER_STATE_CODESET_20150601='5' where USER_STATE_CODESET_20150601='T';
	update uni_06mth_1102 set USER_STATE_CODESET_20150601='6' where USER_STATE_CODESET_20150601='U';
	update uni_06mth_1102 set USER_STATE_CODESET_20150601='5' where USER_STATE_CODESET_20150601='X';
	update uni_06mth_1102 set USER_STATE_CODESET_20150601='5' where USER_STATE_CODESET_20150601='M';
	update uni_06mth_1102 set USER_STATE_CODESET_20150601='5' where USER_STATE_CODESET_20150601='e';
	
	update uni_06mth_1102 set USER_STATE_CODESET_20150531='3' where USER_STATE_CODESET_20150531='2';
	update uni_06mth_1102 set USER_STATE_CODESET_20150531='2' where USER_STATE_CODESET_20150531='4';
	update uni_06mth_1102 set USER_STATE_CODESET_20150531='4' where USER_STATE_CODESET_20150531='6';
	update uni_06mth_1102 set USER_STATE_CODESET_20150531='7' where USER_STATE_CODESET_20150531='7';
	update uni_06mth_1102 set USER_STATE_CODESET_20150531='5' where USER_STATE_CODESET_20150531='5';
	update uni_06mth_1102 set USER_STATE_CODESET_20150531='6' where USER_STATE_CODESET_20150531='9';
	update uni_06mth_1102 set USER_STATE_CODESET_20150531='2' where USER_STATE_CODESET_20150531='A';
	update uni_06mth_1102 set USER_STATE_CODESET_20150531='3' where USER_STATE_CODESET_20150531='B';
	update uni_06mth_1102 set USER_STATE_CODESET_20150531='4' where USER_STATE_CODESET_20150531='F';
	update uni_06mth_1102 set USER_STATE_CODESET_20150531='2' where USER_STATE_CODESET_20150531='K';
	update uni_06mth_1102 set USER_STATE_CODESET_20150531='5' where USER_STATE_CODESET_20150531='N';
	update uni_06mth_1102 set USER_STATE_CODESET_20150531='5' where USER_STATE_CODESET_20150531='O';
	update uni_06mth_1102 set USER_STATE_CODESET_20150531='5' where USER_STATE_CODESET_20150531='T';
	update uni_06mth_1102 set USER_STATE_CODESET_20150531='6' where USER_STATE_CODESET_20150531='U';
	update uni_06mth_1102 set USER_STATE_CODESET_20150531='5' where USER_STATE_CODESET_20150531='X';
	update uni_06mth_1102 set USER_STATE_CODESET_20150531='5' where USER_STATE_CODESET_20150531='M';
	update uni_06mth_1102 set USER_STATE_CODESET_20150531='5' where USER_STATE_CODESET_20150531='e';

alter table uni_06mth_1102 add lost_tag_6_t2_4g number;	
	update uni_06mth_1102 set lost_tag_6_t2_4g=-1;
  update uni_06mth_1102 set lost_tag_6_t2_4g=0 where
(LOST_TAG_201509=0 and
LOST_TAG_201503=0 and
LOST_TAG_201504=0 and
LOST_TAG_201505=0 and
LOST_TAG_201506=0 and
LOST_TAG_201507=0 and
LOST_TAG_201508=0 ) or
(LOST_TAG_201509=0 and
LOST_TAG_201503=2 and
LOST_TAG_201504=0 and
LOST_TAG_201505=0 and
LOST_TAG_201506=0 and
LOST_TAG_201507=0 and
LOST_TAG_201508=0 ) or
(LOST_TAG_201509=0 and
LOST_TAG_201503=2 and
LOST_TAG_201504=2 and
LOST_TAG_201505=0 and
LOST_TAG_201506=0 and
LOST_TAG_201507=0 and
LOST_TAG_201508=0
);

update uni_06mth_1102 set lost_tag_6_t2_4g=1 where
(LOST_TAG_201509=1 and
LOST_TAG_201503=0 and
LOST_TAG_201504=0 and
LOST_TAG_201505=0 and
LOST_TAG_201506=0 and
LOST_TAG_201507=0) or
(LOST_TAG_201509=1 and
LOST_TAG_201503=2 and
LOST_TAG_201504=0 and
LOST_TAG_201505=0 and
LOST_TAG_201506=0 and
LOST_TAG_201507=0 ) or
(LOST_TAG_201509=1 and
LOST_TAG_201503=2 and
LOST_TAG_201504=2 and
LOST_TAG_201505=0 and
LOST_TAG_201506=0 and
LOST_TAG_201507=0) or
(LOST_TAG_201507=0 and
LOST_TAG_201503=0 and
LOST_TAG_201504=0 and
LOST_TAG_201505=0 and
LOST_TAG_201506=0 and
LOST_TAG_201508=1) or
(LOST_TAG_201507=0 and
LOST_TAG_201503=2 and
LOST_TAG_201504=0 and
LOST_TAG_201505=0 and
LOST_TAG_201506=0 and
LOST_TAG_201508=1 ) or
(LOST_TAG_201507=0 and
LOST_TAG_201503=2 and
LOST_TAG_201504=2 and
LOST_TAG_201505=0 and
LOST_TAG_201506=0 and
LOST_TAG_201508=1
);


update uni_06mth_1102 set EPARCHY_TYPE_201506=EPARCHY_TYPE_201506-1;	
	
update uni_06mth_1102 set CREDIT_VALUE_201506=-1 where CREDIT_VALUE_201506=0;	
	update uni_06mth_1102 set MTC_NUM_201506=-1 where MTC_NUM_201506=0;
	update uni_06mth_1102 set NO_LCALL_DURATION_201506=-1 where NO_LCALL_DURATION_201506=0;
	update uni_06mth_1102 set PROV_LCALL_DURATION_201506=-1 where PROV_LCALL_DURATION_201506=0;
	update uni_06mth_1102 set NATIONAL_LCALL_DURATION_201506=-1 where NATIONAL_LCALL_DURATION_201506=0;
	update uni_06mth_1102 set INTERGAT_LCALL_DURATION_201506=-1 where INTERGAT_LCALL_DURATION_201506=0;
	update uni_06mth_1102 set NOINTERGATLCALLDURATION_201506=-1 where NOINTERGATLCALLDURATION_201506=0;
	update uni_06mth_1102 set ROAM_CALL_DURATION_201506=-1 where ROAM_CALL_DURATION_201506=0;
	update uni_06mth_1102 set BILL_DURATION_01_201506=-1 where BILL_DURATION_01_201506=0;
	update uni_06mth_1102 set DEBT_FEE_201506=-1 where DEBT_FEE_201506=0;
	update uni_06mth_1102 set NOT_PACKAGE_USE_201506_201506=-1 where NOT_PACKAGE_USE_201506_201506=0;
	update uni_06mth_1102 set FREE_FLOW_USE_201506=-1 where FREE_FLOW_USE_201506=0;
	update uni_06mth_1102 set ROAM_STREAM_01_201506=-1 where ROAM_STREAM_01_201506=0;
	update uni_06mth_1102 set ROAM_STREAM_02_201506=-1 where ROAM_STREAM_02_201506=0;
	update uni_06mth_1102 set ROAM_STREAM_04_201506=-1 where ROAM_STREAM_04_201506=0;
	update uni_06mth_1102 set SMS_NUMS_201506=-1 where SMS_NUMS_201506=0;


create table yuanshishuju_1102_5 as (select
to_number(EPARCHY_CODE_201505) as EPARCHY_CODE_201505
,to_number(USER_ID) as USER_ID
,to_number(ID_1) as ID_1
,to_number(ID_2) as ID_2
,to_number(EPARCHY_TYPE_201505) as EPARCHY_TYPE_201505
,to_number(ACTION_END_DATE_201505) as ACTION_END_DATE_201505
,to_number(CREDIT_VALUE_201505) as CREDIT_VALUE_201505
,to_number(JOIN_MONTH_201505) as JOIN_MONTH_201505
,to_number(ROAM_TAG_03_201505) as ROAM_TAG_03_201505
,to_number(MTC_NUM_201505) as MTC_NUM_201505
,to_number(NO_LCALL_DURATION_201505) as NO_LCALL_DURATION_201505
,to_number(PROV_LCALL_DURATION_201505) as PROV_LCALL_DURATION_201505
,to_number(NATIONAL_LCALL_DURATION_201505) as NATIONAL_LCALL_DURATION_201505
,to_number(INTERGAT_LCALL_DURATION_201505) as INTERGAT_LCALL_DURATION_201505
,to_number(NOINTERGATLCALLDURATION_201505) as NOINTERGATLCALLDURATION_201505
,to_number(ROAM_CALL_DURATION_201505) as ROAM_CALL_DURATION_201505
,to_number(BILL_DURATION_01_201505) as BILL_DURATION_01_201505
,to_number(CZ_FEE_01_201505) as CZ_FEE_01_201505
,to_number(CUR_INCOME_201505) as CUR_INCOME_201505
,to_number(PROM_FEE_201505) as PROM_FEE_201505
,to_number(DEBT_FEE_201505) as DEBT_FEE_201505
,to_number(NOT_PACKAGE_USE_201505_201505) as NOT_PACKAGE_USE_201505_201505
,to_number(FREE_FLOW_USE_201505) as FREE_FLOW_USE_201505
,to_number(ROAM_STREAM_01_201505) as ROAM_STREAM_01_201505
,to_number(ROAM_STREAM_02_201505) as ROAM_STREAM_02_201505
,to_number(ROAM_STREAM_04_201505) as ROAM_STREAM_04_201505
,to_number(VOICEOVER_TAG_201505) as VOICEOVER_TAG_201505
,to_number(SMS_NUMS_201505) as SMS_NUMS_201505
,to_number(USER_STATE_CODESET_20150523) as USER_STATE_CODESET_20150523
,to_number(USER_STATE_CODESET_20150501) as USER_STATE_CODESET_20150501
,to_number(USER_STATE_CODESET_20150430) as USER_STATE_CODESET_20150430
,to_number(LOST_TAG_5_T2_4g) as LOST_TAG_5_T2_4g
from uni_05mth_1102 where lost_tag_5_t2_4g!=-1);

create table yuanshishuju_1102_6 as (select
to_number(EPARCHY_CODE_201506) as EPARCHY_CODE_201506
,to_number(USER_ID) as USER_ID
,to_number(ID_1) as ID_1
,to_number(ID_2) as ID_2
,to_number(EPARCHY_TYPE_201506) as EPARCHY_TYPE_201506
,to_number(ACTION_END_DATE_201506) as ACTION_END_DATE_201506
,to_number(CREDIT_VALUE_201506) as CREDIT_VALUE_201506
,to_number(JOIN_MONTH_201506) as JOIN_MONTH_201506
,to_number(ROAM_TAG_03_201506) as ROAM_TAG_03_201506
,to_number(MTC_NUM_201506) as MTC_NUM_201506
,to_number(NO_LCALL_DURATION_201506) as NO_LCALL_DURATION_201506
,to_number(PROV_LCALL_DURATION_201506) as PROV_LCALL_DURATION_201506
,to_number(NATIONAL_LCALL_DURATION_201506) as NATIONAL_LCALL_DURATION_201506
,to_number(INTERGAT_LCALL_DURATION_201506) as INTERGAT_LCALL_DURATION_201506
,to_number(NOINTERGATLCALLDURATION_201506) as NOINTERGATLCALLDURATION_201506
,to_number(ROAM_CALL_DURATION_201506) as ROAM_CALL_DURATION_201506
,to_number(BILL_DURATION_01_201506) as BILL_DURATION_01_201506
,to_number(CZ_FEE_01_201506) as CZ_FEE_01_201506
,to_number(CUR_INCOME_201506) as CUR_INCOME_201506
,to_number(PROM_FEE_201506) as PROM_FEE_201506
,to_number(DEBT_FEE_201506) as DEBT_FEE_201506
,to_number(NOT_PACKAGE_USE_201506_201506) as NOT_PACKAGE_USE_201506_201506
,to_number(FREE_FLOW_USE_201506) as FREE_FLOW_USE_201506
,to_number(ROAM_STREAM_01_201506) as ROAM_STREAM_01_201506
,to_number(ROAM_STREAM_02_201506) as ROAM_STREAM_02_201506
,to_number(ROAM_STREAM_04_201506) as ROAM_STREAM_04_201506
,to_number(VOICEOVER_TAG_201506) as VOICEOVER_TAG_201506
,to_number(SMS_NUMS_201506) as SMS_NUMS_201506
,to_number(USER_STATE_CODESET_20150623) as USER_STATE_CODESET_20150623
,to_number(USER_STATE_CODESET_20150601) as USER_STATE_CODESET_20150601
,to_number(USER_STATE_CODESET_20150531) as USER_STATE_CODESET_20150531
,to_number(LOST_TAG_6_T2_4G) as LOST_TAG_6_T2_4G
from uni_06mth_1102 where lost_tag_6_t2_4g!=-1);

	
